<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <script>
      (function () {
        var t = localStorage.getItem('iflow-theme');
        if (t === 'light') document.documentElement.classList.add('theme-light');
        else if (t === 'dark') document.documentElement.classList.add('theme-dark');
      })();
    </script>
    <link rel="stylesheet" href="/src/styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>flow hub</title>
  </head>
  <body>
    <div id="app">
      <!-- ä¾§è¾¹æ ï¼šAgent åˆ—è¡¨ -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <h1>flow hub</h1>
          <button id="add-agent-btn" class="btn-primary">+ æ·»åŠ  Agent</button>
        </div>
        <div class="agent-list" id="agent-list">
          <!-- Agent åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </div>
        <div class="session-section">
          <div class="session-section-title">ä¼šè¯å†å²</div>
          <div class="session-list" id="session-list">
            <div class="session-empty">é€‰æ‹© Agent åæ˜¾ç¤ºä¼šè¯å†å²</div>
          </div>
        </div>
        <div class="sidebar-footer">
          <div class="connection-status" id="connection-status">
            <span class="status-dot disconnected"></span>
            <span>æœªè¿æ¥</span>
          </div>
          <div class="sidebar-footer-actions">
            <button id="clear-all-sessions" class="btn-text">æ¸…é™¤å½“å‰ Agent ä¼šè¯</button>
            <div id="app-version" class="app-version-inline">v--</div>
          </div>
        </div>
      </aside>

      <!-- ä¸»å†…å®¹åŒº -->
      <main class="main-content">
        <!-- é¡¶éƒ¨å·¥å…·æ  -->
        <header class="toolbar">
          <div class="current-agent">
            <h2 id="current-agent-name">é€‰æ‹©ä¸€ä¸ª Agent</h2>
            <span id="current-agent-status" class="badge">ç¦»çº¿</span>
            <div class="model-selector">
              <button
                id="current-agent-model-btn"
                class="model-selector-btn"
                type="button"
                disabled
                aria-expanded="false"
              >
                <span id="current-agent-model-text">æ¨¡å‹ï¼šæœªè¿æ¥</span>
                <span class="model-selector-caret">â–¾</span>
              </button>
              <div id="current-agent-model-menu" class="model-selector-menu hidden"></div>
            </div>
          </div>
          <div class="toolbar-actions">
            <button id="theme-toggle-btn" class="btn-icon" title="è·Ÿéšç³»ç»Ÿ">â—‘</button>
            <button id="new-session-btn" class="btn-secondary" disabled>æ–°å»ºä¼šè¯</button>
            <button id="clear-chat-btn" class="btn-secondary" disabled>æ¸…ç©ºå½“å‰ä¼šè¯</button>
          </div>
        </header>

        <!-- å¯¹è¯åŒºåŸŸ -->
        <div class="chat-container">
          <div id="chat-messages" class="chat-messages">
            <div class="welcome-message">
              <h3>ğŸ‘‹ æ¬¢è¿ä½¿ç”¨ flow hub</h3>
              <p>ä»å·¦ä¾§é€‰æ‹©ä¸€ä¸ª Agent å¼€å§‹å¯¹è¯ï¼Œæˆ–æ·»åŠ æ–°çš„ Agentã€‚</p>
            </div>
          </div>

          <!-- å·¥å…·è°ƒç”¨é¢æ¿ -->
          <div id="tool-calls-panel" class="tool-calls-panel hidden">
            <div class="tool-calls-header">
              <h4>ğŸ”§ å·¥å…·è°ƒç”¨</h4>
              <button id="close-tool-panel" class="btn-icon">Ã—</button>
            </div>
            <div id="tool-calls-list" class="tool-calls-list">
              <!-- å·¥å…·è°ƒç”¨å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
          </div>
        </div>

        <!-- è¾“å…¥åŒºåŸŸ -->
        <div class="input-container">
          <div class="input-wrapper">
            <div class="composer-pane">
              <div id="slash-command-menu" class="slash-command-menu hidden"></div>
              <textarea 
                id="message-input" 
                placeholder="è¾“å…¥æ¶ˆæ¯..." 
                rows="1"
                disabled
              ></textarea>
            </div>
            <button id="send-btn" class="btn-send" disabled>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="22" y1="2" x2="11" y2="13"></line>
                <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
              </svg>
            </button>
          </div>
          <div class="input-hints">
            <span id="input-status-hint">æŒ‰ Enter å‘é€ï¼ŒShift + Enter æ¢è¡Œ</span>
          </div>
        </div>
      </main>
    </div>

    <!-- æ·»åŠ  Agent å¼¹çª— -->
    <div id="add-agent-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>æ·»åŠ  iFlow Agent</h3>
          <button id="close-modal" class="btn-icon">Ã—</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="agent-name">Agent åç§°</label>
            <input type="text" id="agent-name" placeholder="æˆ‘çš„ iFlow" value="iFlow">
          </div>
          <div class="form-group">
            <label for="iflow-path">iFlow CLI è·¯å¾„ï¼ˆå¯é€‰ï¼‰</label>
            <input type="text" id="iflow-path" placeholder="iflowï¼ˆä½¿ç”¨ç³»ç»Ÿ PATHï¼‰">
          </div>
          <div class="form-group">
            <label for="workspace-path">å·¥ä½œç›®å½•</label>
            <input type="text" id="workspace-path" placeholder="/path/to/workspace" value="/Users/chenweilong/playground">
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-add-agent" class="btn-secondary">å–æ¶ˆ</button>
          <button id="confirm-add-agent" class="btn-primary">è¿æ¥</button>
        </div>
      </div>
    </div>

    <!-- ç¼–è¾‘ Agent åç§°å¼¹çª— -->
    <div id="rename-agent-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>ç¼–è¾‘ Agent åç§°</h3>
          <button id="close-rename-agent-modal" class="btn-icon">Ã—</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="rename-agent-name">Agent åç§°</label>
            <input type="text" id="rename-agent-name" placeholder="è¯·è¾“å…¥ Agent åç§°">
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-rename-agent" class="btn-secondary">å–æ¶ˆ</button>
          <button id="confirm-rename-agent" class="btn-primary">ä¿å­˜</button>
        </div>
      </div>
    </div>

    <!-- HTML Artifact é¢„è§ˆå¼¹çª— -->
    <div id="artifact-preview-modal" class="modal hidden">
      <div class="modal-content artifact-preview-modal-content">
        <div class="modal-header">
          <h3>HTML é¢„è§ˆ</h3>
          <button id="close-artifact-preview" class="btn-icon">Ã—</button>
        </div>
        <div class="modal-body artifact-preview-meta">
          <div id="artifact-preview-path"></div>
        </div>
        <div class="artifact-preview-body">
          <iframe
            id="artifact-preview-frame"
            class="artifact-preview-frame"
            sandbox="allow-scripts allow-same-origin"
          ></iframe>
        </div>
      </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
